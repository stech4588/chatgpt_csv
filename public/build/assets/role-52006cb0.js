import{_ as V,r as h,o as i,c as n,a as e,w as R,b as I,v as E,n as C,d as c,t as u,i as y,e as p,h as g,F as k,j as v,g as S}from"./app-8617d8f9.js";const T={name:"Role",scrollToTop:!1,inject:["authStore"],data(){return{form:new this.$form({searchInput:""}),currentPage:1,totalPages:1,currentPageData:[],roleId:0,roleUpdate:!1,roleAdd:!1,roleDelete:!1,role:!1,loading:!0,roleView:!1,view:5}},computed:{visiblePaginationLinks(){const t=Math.floor(2.5);let r=Math.max(1,this.currentPage-t),d=Math.min(this.totalPages,r+5-1);this.totalPages>=5&&d===this.totalPages&&(r=Math.max(1,d-5+1));const s=[];for(let l=r;l<=d;l++)s.push(l);return s}},async mounted(){if(this.authStore.user===null)this.loading=!1;else{let a=!1;try{const t=["roleAdd","roleUpdate","roleView","roleDelete"],r=await checkPermissions(t);t.forEach(d=>{r[d]&&(this[d]=!0,d==="roleView"&&(a=!0))})}catch(t){handleError(t,this.$toast)}await this.fetchRoleList(a)}},methods:{async changePage(a){try{const t=await this.$axios.get(`/api/role?page=${a}&view=${this.view}&search=${this.form.searchInput}`);this.currentPage=t.data.data.current_page,this.currentPageData=t.data.data.data}catch(t){handleError(t,this.$toast)}},async fetchRoleList(a){if(a){try{await this.$axios.get(`/api/role?view=${this.view}`).then(t=>{this.currentPageData=t.data.data.data,this.totalPages=t.data.data.last_page})}catch(t){handleError(t,this.$toast)}this.loading=!1}else this.loading=!1},async deleteRole(a){if(await this.showConfirmationDialog("Are you sure you want to delete this Role?"))try{await this.$axios.delete(`/api/role/${a}`).then(r=>{r.data.status===200&&(this.$toast.success(r.data.message,{position:"top-right",duration:3e3}),this.fetchRoleList(!0))})}catch(r){handleError(r,this.$toast)}},async SearchRole(){try{await this.$axios.get("/api/role",{params:{search:this.form.searchInput,view:this.view}}).then(a=>{this.currentPageData=a.data.data.data,this.totalPages=a.data.data.last_page})}catch(a){handleError(a,this.$toast)}}}},U={key:0},M={key:0},N=e("h1",null,"Roles",-1),A={class:"container"},B={class:"row justify-content-center"},j={class:"col-md-8"},z={class:"input-group mb-3"},F={class:"input-group-append"},O=["disabled"],$={class:"text-end my-3"},K={key:0},q={class:"table table-bordered"},G=e("thead",{class:"text-white grey-bg"},[e("tr",null,[e("th",{class:""}," ID "),e("th",{class:"col-1"}," Title "),e("th",{class:"col-2"}," Description "),e("th",{class:"col-2"}," Permissions "),e("th",{class:"col-8 text-center"}," Action ")])],-1),H={class:"d-flex flex-wrap"},J={key:0},Q={class:"text-center"},W=["onClick"],X={key:1,class:"d-flex justify-content-center align-items-center"},Y=e("h3",null,"NO RECORD FOUND",-1),Z=[Y],ee={key:1},te={key:1};function se(a,t,r,d,s,l){const P=h("has-error"),_=h("font-awesome-icon"),f=h("router-link"),b=h("pagination"),x=h("Unauthorized"),L=h("Loader");return s.loading===!1?(i(),n("div",U,[s.roleView===!0?(i(),n("div",M,[N,e("div",A,[e("div",B,[e("div",j,[e("form",{onSubmit:t[1]||(t[1]=R((...o)=>l.SearchRole&&l.SearchRole(...o),["prevent"])),onKeydown:t[2]||(t[2]=o=>s.form.onKeydown(o))},[e("div",z,[I(e("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>s.form.searchInput=o),class:C([{"is-invalid":s.form.errors.has("searchInput")},"form-control"]),placeholder:"Search Records By TITLE...",type:"text",name:"searchInput"},null,2),[[E,s.form.searchInput]]),c(P,{form:s.form,field:"searchInput"},null,8,["form"]),e("div",F,[e("button",{class:"btn grey-bg ms-2",disabled:s.form.busy},u("Search"),8,O)])])],32)])])]),e("div",$,[s.roleAdd?(i(),y(f,{key:0,to:{name:"role.add"},class:"btn linked-icon"},{default:p(()=>[c(_,{icon:"plus","fixed-width":""})]),_:1},8,["to"])):g("",!0)]),s.currentPageData.length>0?(i(),n("div",K,[e("table",q,[G,e("tbody",null,[(i(!0),n(k,null,v(s.currentPageData,(o,D)=>(i(),n("tr",{key:D},[e("td",null,u(o.id),1),e("td",null,u(o.name),1),e("td",null,u(o.description),1),e("td",null,[e("div",H,[(i(!0),n(k,null,v(o.permissions,(m,w)=>(i(),n("div",{key:w},[S(u(m.name)+" ",1),w!==o.permissions.length-1?(i(),n("span",J,", ")):g("",!0)]))),128))])]),e("td",Q,[c(f,{to:{path:`/viewrole/${o.id}`},class:"btn linked-icon"},{default:p(()=>[c(_,{icon:"eye","fixed-width":""})]),_:2},1032,["to"]),s.roleUpdate?(i(),y(f,{key:0,to:{path:`/updaterole/${o.id}`},class:"btn linked-icon"},{default:p(()=>[c(_,{icon:"pen","fixed-width":""})]),_:2},1032,["to"])):g("",!0),s.roleDelete?(i(),n("button",{key:1,class:"btn linked-icon",onClick:m=>l.deleteRole(o.id)},[c(_,{icon:"trash","fixed-width":""})],8,W)):g("",!0)])]))),128))])]),e("div",null,[c(b,{currentPage:s.currentPage,totalPages:s.totalPages,visiblePaginationLinks:l.visiblePaginationLinks,changePage:l.changePage},null,8,["currentPage","totalPages","visiblePaginationLinks","changePage"])])])):(i(),n("div",X,Z))])):(i(),n("div",ee,[c(x)]))])):(i(),n("div",te,[c(L)]))}const oe=V(T,[["render",se]]);export{oe as default};
